<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DataFakeR workflow • DataFakeR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="DataFakeR workflow">
<meta property="og:description" content="DataFakeR">
<meta property="og:image" content="https://openpharma.github.io/DataFakeR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DataFakeR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-thumbs-o-up"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/main.html">Welcome</a>
    </li>
    <li>
      <a href="../articles/datafaker_workflow.html">DataFakeR workflow</a>
    </li>
    <li>
      <a href="../articles/schema_structure.html">YAML schema structure</a>
    </li>
    <li>
      <a href="../articles/structure_from_db.html">Sourcing structure from database</a>
    </li>
    <li>
      <a href="../articles/simulation_options.html">Simulation Options</a>
    </li>
    <li>
      <a href="../articles/simulation_methods.html">Simulation Methods</a>
    </li>
    <li>
      <a href="../articles/extra_parameters.html">Extra parameters</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/openpharma/DataFakeR/issues" class="external-link">
    <span class="fa fa-ambulance"></span>
     
    Issues
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/openpharma/DataFakeR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>DataFakeR workflow</h1>
                        <h4 data-toc-skip class="author">Krystian
Igras</h4>
            
            <h4 data-toc-skip class="date">2023-02-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/DataFakeR/blob/HEAD/vignettes/datafaker_workflow.Rmd" class="external-link"><code>vignettes/datafaker_workflow.Rmd</code></a></small>
      <div class="hidden name"><code>datafaker_workflow.Rmd</code></div>

    </div>

    
    
<p>The main goal of DataFakeR package is to simulate fake data based on
table(s) configuration.</p>
<div class="section level3">
<h3 id="creating-table-schema">Creating table schema<a class="anchor" aria-label="anchor" href="#creating-table-schema"></a>
</h3>
<p>The configuration file describing schema can be automatically created
based on <a href="structure_from_db.html">database configuration</a>, R
named list of tables and/or customized manually (see <a href="schema_structure.html">schema structure</a>).</p>
<p>When the schema should be dumped from database simply run:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>schema <span class="ot">&lt;-</span> <span class="fu">schema_source</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">source =</span> <span class="sc">&lt;</span>db<span class="sc">-</span>connection<span class="sc">-</span>object<span class="sc">&gt;</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">schema_name =</span> <span class="sc">&lt;</span>target<span class="sc">-</span>schema<span class="sc">-</span>name<span class="sc">&gt;</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="sc">&lt;</span>target<span class="sc">-</span>schema<span class="sc">-</span>configuration<span class="sc">-</span>file<span class="sc">&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>If you want to create dump from list of tables run:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>schema <span class="ot">&lt;-</span> <span class="fu">schema_source</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">source =</span> <span class="sc">&lt;</span>named<span class="sc">-</span>list<span class="sc">-</span>of<span class="sc">-</span>tables<span class="sc">&gt;</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">schema_name =</span> <span class="sc">&lt;</span>target<span class="sc">-</span>schema<span class="sc">-</span>name<span class="sc">&gt;</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="sc">&lt;</span>target<span class="sc">-</span>schema<span class="sc">-</span>configuration<span class="sc">-</span>file<span class="sc">&gt;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The function will read necessary schema information and save it in
<code>file</code> yaml file. As a result the new R6 object will be
returned storing all the necessary information about the datasets, that
allow the package to perform simulation step.</p>
<p><strong>Note:</strong> You may customize data sourcing options using
<code>schema_source</code>’s <code>faker_opts</code> parameter. See <a href="structure_from_db.html">dump configuration</a>.</p>
<p>If you already have defined yaml configuration file, you may also use
<code>schema_source</code> to read the schema object. Just use the
function providing schema file path as a <code>source</code>
parameter:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>schema <span class="ot">&lt;-</span> <span class="fu">schema_source</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">source =</span> <span class="sc">&lt;</span>source<span class="sc">-</span>schema<span class="sc">-</span>configuration<span class="sc">-</span>file<span class="sc">&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Note:</strong> You can see both schema sourcing and
simulation progress by setting
<code>options("dfkr_verbose" = TRUE)</code>.</p>
</div>
<div class="section level3">
<h3 id="simulating-data">Simulating data<a class="anchor" aria-label="anchor" href="#simulating-data"></a>
</h3>
<p>In order to simulate the data, pass <code>schema</code> object to
<code>schema_simulate</code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/schema_methods.html">schema_simulate</a></span><span class="op">(</span><span class="va">schema</span><span class="op">)</span></span></code></pre></div>
<p>The simulation process is highly configurable. For more details see
<a href="simulation_options.html">simulation options</a>.</p>
</div>
<div class="section level3">
<h3 id="accessing-simulated-data">Accessing simulated data<a class="anchor" aria-label="anchor" href="#accessing-simulated-data"></a>
</h3>
<p>The simulated tables can be accessed with using
<code>schema_get_table</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>table_a <span class="ot">&lt;-</span> <span class="fu">schema_get_table</span>(schema, <span class="sc">&lt;</span>table<span class="sc">-</span>name<span class="sc">&gt;</span>)</span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="the-other-schema-methods">The other schema methods<a class="anchor" aria-label="anchor" href="#the-other-schema-methods"></a>
</h2>
<div class="section level3">
<h3 id="display-table-dependencies">Display table dependencies<a class="anchor" aria-label="anchor" href="#display-table-dependencies"></a>
</h3>
<p>In order to perform tables simulation and preserve its original
structure DataFakeR detects dependencies between tables and columns.
Such dependencies sets the order of tables and columns simulation. For
example having <code>table_a$column_a</code> as a foreign key for
<code>table_b$column_b</code>, <code>table_b</code> will be simulated
before <code>table_a</code>.</p>
<p>Table dependencies are defined by foreign keys definition, whereas
inner-table column dependencies consider multiple parameters defined in
yaml configuration. Such cases are:</p>
<ul>
<li>the column is <a href="extra_parameters.html">grouped by</a> another
one,</li>
<li>the column is bounded by equality constraint with another one,</li>
<li>the column is defined by <a href="simulation_methods.Rmd">formula</a> in which the other column was
used.</li>
</ul>
<p>To check tables dependencies use:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/schema_methods.html">schema_plot_deps</a></span><span class="op">(</span><span class="va">schema</span><span class="op">)</span></span></code></pre></div>
<p>To check column dependencies for selected table use:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">schema_plot_deps</span>(schema, <span class="at">table_name =</span> <span class="sc">&lt;</span>table<span class="sc">-</span>name<span class="sc">&gt;</span>)</span></code></pre></div>
<p>Example output:</p>
<p><img src="assets/column_deps.png"></p>
</div>
<div class="section level3">
<h3 id="updating-schema-object">Updating schema object<a class="anchor" aria-label="anchor" href="#updating-schema-object"></a>
</h3>
<p>While trying to simulate the target data you may want to improve the
currently defined configuration file. If you want to update the object
using new version of the file (and new simulation options) without the
need to source it from scratch just use:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>schema <span class="ot">&lt;-</span> <span class="fu">schema_update_source</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  schema, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="sc">&lt;</span>new<span class="sc">-</span>version<span class="sc">-</span>source<span class="sc">-</span>file<span class="sc">&gt;</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">faker_opts =</span> <span class="sc">&lt;</span>new<span class="sc">-</span>simulation<span class="sc">-</span>options<span class="sc">&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Krystian Igras.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
